--- net/bluetooth/bnep/core.c
+++ net/bluetooth/bnep/core.c
@@ -511,12 +511,13 @@
 
 static struct device *bnep_get_device(struct bnep_session *session)
 {
-	struct l2cap_conn *conn = l2cap_pi(session->sock->sk)->chan->conn;
+	struct hci_conn *conn;
 
-	if (!conn || !conn->hcon)
+	conn = l2cap_pi(session->sock->sk)->chan->conn->hcon;
+	if (!conn)
 		return NULL;
 
-	return &conn->hcon->dev;
+	return &conn->dev;
 }
 
 static struct device_type bnep_type = {
@@ -532,9 +533,6 @@
 
 	BT_DBG("");
 
-	if (!l2cap_is_socket(sock))
-		return -EBADFD;
-
 	baswap((void *) dst, &l2cap_pi(sock->sk)->chan->dst);
 	baswap((void *) src, &l2cap_pi(sock->sk)->chan->src);
 
