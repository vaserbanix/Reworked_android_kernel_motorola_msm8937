--- drivers/staging/comedi/comedi_fops.c
+++ drivers/staging/comedi/comedi_fops.c
@@ -2590,6 +2590,9 @@
 
 	comedi_class->dev_groups = comedi_dev_groups;
 
+	/* XXX requires /proc interface */
+	comedi_proc_init();
+
 	/* create devices files for legacy/manual use */
 	for (i = 0; i < comedi_num_legacy_minors; i++) {
 		struct comedi_device *dev;
@@ -2607,9 +2610,6 @@
 		mutex_unlock(&dev->mutex);
 	}
 
-	/* XXX requires /proc interface */
-	comedi_proc_init();
-
 	return 0;
 }
 module_init(comedi_init);
